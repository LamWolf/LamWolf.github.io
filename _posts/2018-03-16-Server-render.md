---
layout: post
title: "server-render的脉络"
author: "LamWolf"
tags: 
    - 前端
    - egg.js
    - server-render
date: 2018-03-16 15:25:00
catalog: true
header-img: "img/post-bg-network.jpg"
---

## 写在前面

自上一篇博客到现在，已经半年左右了。这半年里，实习，找新的实习，失败，收心留下，请假回学校处理学业问题，等等，经历了不少事。之前想好要更新的博文，也放了鸽子，说白了还是懒了，以工作的业务压力为借口欺骗自己，借机偷懒。

转眼快要毕业了，offer也拿到了一个，虽然不甚圆满，但也算是有个保底的了。这几天业务需求比较少，在做公司旧项目向server-render的迁移工作，在闲暇时思考除了完成这些工作，是不是也该再学习总结些什么。恰好收到了域名续费通知，就决定厚着脸皮再捡起这个博客。

关于之后的更新打算，不再是单一的长篇学习文，也会有很多随笔短文（预感自己将会有大量的随笔短文发布，先立个flag），这些短文会有对自己的思考，也会有对某一知识点的思考（如本文），倒是文章的头图成了一个问题，可能需要去找一个defaultImg了。

## 目录

1. 什么是server-render
2. server-render的基本原理
3. server-render的优势
4. 我现在应该做什么？

## 正文从这里开始

### 1.什么是server-render

server-render如字面意思，服务端渲染，即在服务端完成渲染后，把渲染好的页面发给请求方。

### 2.server-render的基本原理

了解前端的同学都知道，页面渲染的步骤，尤其是MVC和前后端分离的思路下，拿到template和data后，将其组装到一起后，才能渲染出页面，在网络层面考虑，就需要先download好HTML文件、css文件和js文件，再从API接口拿到data，这时浏览器才能够把页面render出来。

服务端渲染主要针对的是首屏渲染。开发者会将原来的数据接口进行封装，当接收到请求后，服务端会在内网中请求数据接口，然后将获得的数据以及HTML文件、css文件组合render出首屏页面，再将渲染好的HTML页面发送给请求方。

### 3.server-render的优势

根据上文的介绍，可以大概了解，传统的渲染方式，对服务端会发起两“次”请求，一“次”是页面请求，页面过来后，根据需要再进行一“次”数据接口请求，得到数据后才能够渲染页面。

现在的国内的网络环境，大部分是感知不到这两个过程的。不过假设现在的网络环境比较差，比如丢包率高，或者网络延迟高，那么在这种多次请求的情况下，就意味着首屏加载会非常容易出现一直在加载中的状态，直到你忍受不了关掉了页面...这种情况在国内一般情况下不太经常出现，不过如果访问者在国外，需要通过公网访问国内的服务器，那这种情况出现的几率就非常大了。

而对于sever-render，当接收到请求后，首屏的数据获取在内网中进行，延迟和丢包就可以忽略不计，数据传输的效率大大增加，首屏渲染的速度会非常快。这就是相对于传统渲染方式的优势。

### 4.我现在应该做什么

初次接触server-render的项目后，会发现server-render项目与传统项目一个比较大的不同是项目的文档结构，个人感觉，server-render的项目结构会更加复杂一些，当业务项目非常大的时候，会出现非常多的Controller层文件和Service层文件，不过相对的，项目的耦合度会降低，复杂的点更多在于项目路径更深，但其实项目脉络还是比较清晰的。

在考虑到项目文件会越来越多，项目的模块化就需要提前规划好，更高效的模块分类能够使项目结构更加条理，更便于后期维护。